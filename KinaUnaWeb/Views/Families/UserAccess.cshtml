@model KinaUnaWeb.Models.FamiliesViewModels.UserGroupsViewModel
@using KinaUna.Data
@using KinaUna.Data.Models.AccessManagement
@using KinaUna.Data.Models.Family
@using KinaUnaWeb.Services
@inject ILocaleManager LocaleManager
@{
    ViewData["Title"] = await LocaleManager.GetTranslation("Manage User Access", PageNames.Family, Model.LanguageId);
}
<div class="row m-0">
    <div class="col-12">
        <div class="page-tab-container">
            <div class="page-tab" id="page-title-div">
                <a class="btn-page-tab leave-page" asp-controller="Families" asp-action="Index">
                    <i class="material-icons sidebar-icon">fact_check</i>@await LocaleManager.GetTranslation("Family Members", PageNames.Family, Model.LanguageId)
                </a>
            </div>
            <div class="page-tab">
                <a class="btn-page-tab leave-page" asp-controller="Families" asp-action="Members">
                    <i class="material-icons sidebar-icon">group</i> @await LocaleManager.GetTranslation("Family Members", PageNames.Family, Model.LanguageId)
                </a>
            </div>
            <div class="page-tab active">
                <a class="btn-page-tab active leave-page" asp-controller="Families" asp-action="UserAccess">
                    <i class="material-icons sidebar-icon">lock_person</i> @await LocaleManager.GetTranslation("User Access", PageNames.Family, Model.LanguageId)
                </a>
            </div>
        </div>
    </div>
</div>
<div class="row m-0">
    <div class="col-12">
        Family Access
    </div>
    @foreach (Family family in Model.FamiliesList)
    {
        <div class="col-12 mt-3 mb-1 h5">
            <i class="material-icons kinauna-icon-medium" style="font-size: 32px">family_restroom</i> @family.Name
        </div>

        @foreach (UserGroup userGroup in Model.UserGroups)
        {
            if (userGroup.FamilyId == family.FamilyId)
            {
                <div class="col-12">
                    <span>Group name: @userGroup.Name</span><span>Permission: @userGroup.PermissionLevel.ToString()</span>
                </div>
                <div class="col-12">
                    Members:
                    <div class="row">
                        @foreach (UserGroupMember userGroupMember in userGroup.Members)
                        {
                            <div class="col-12">
                                <span>@userGroupMember.Email</span>
                            </div>
                        }
                    </div>
                </div>
            }
        }
    }
</div>
<div class="row m-0">
    <div class="col-12">
        Individual Access
    </div>
    @foreach (Progeny progeny in Model.ProgenyList)
    {
        <div class="col-12 mt-3 mb-1 h5">
            <i class="material-icons kinauna-icon-medium" style="font-size: 32px">family_restroom</i> @progeny.NickName
        </div>
        @foreach (UserGroup userGroup in Model.UserGroups)
        {
            if (userGroup.ProgenyId == progeny.Id)
            {
                <div class="col-12">
                    <span>Group name: @userGroup.Name</span><span>Permission: @userGroup.PermissionLevel.ToString()</span>
                </div>
                <div class="col-12">
                    Members:
                    <div class="row">
                        @foreach (UserGroupMember userGroupMember in userGroup.Members)
                        {
                            <div class="col-12">
                                <span>@userGroupMember.Email</span>
                            </div>
                        }
                    </div>
                </div>
            }
        }
    }
</div>
